---
import { getCollection, render } from "astro:content";
import Layout from "../../layouts/Layout.astro";
import DocsEntry from "../../components/DocsEntry.astro";
import { sectionAndSortEntries } from "../../utils/docsCollections";

export async function getStaticPaths() {
  const docsEntries = sectionAndSortEntries(await getCollection("docs", x => !x.id.includes("/runtime/")));

  return docsEntries.map((entry, i) => ({
    params: { slug: entry.collectionEntry.id },
    props: {
      entry: entry.collectionEntry,
      section: entry.section,
      prev: docsEntries[i - 1]?.collectionEntry,
      next: docsEntries[i + 1]?.collectionEntry
    },
  }));
}

const { entry, section, prev, next } = Astro.props;
const { Content, headings } = await render(entry);
---

<Layout title={`Grain Docs | ${entry.data.title}`} inDocs excludeFooter>
	<DocsEntry data={entry.data} section={section} headings={headings} prev={prev} next={next}>
		<Content />
  </DocsEntry>
</Layout>
