---
import { Image } from "astro:assets";
import GithubIcon from "./icons/GithubIcon.astro";

interface Props {
  profileImage: ImageMetadata;
  name: string;
  title: string;
  role: string;
  githubUsername: string;
}

const { profileImage, name, title, role, githubUsername } = Astro.props;
---

<div class="md:hidden bg-color-dim-3 rounded-2xl drop-shadow-sm border border-gray-10 dark:border-color-background-bright dark:bg-color-dim-3 overflow-hidden">
  <div class="p-5">
    <div class="flex items-center gap-4">
      <Image
        src={profileImage}
        alt=`A picture of ${name}`
        class="rounded-full object-cover w-20 h-20"
      />
      <div class="w-fit">
        <h2 class="text-2xl font-bold mb-1">{name}</h2>
        <h3 class="text-base">{title}</h3>
      </div>
    </div>

    <h3 class="text-gray-50 mt-4 border-bottom border-black text-sm">{role}</h3>
  </div>
  <div class="flex flex-col gap-3 pt-4 bg-color-background-bright dark:bg-color-dim-3 p-5">
    <slot />
  </div>
</div>

<div class="hidden md:block relative w-[20rem]">
  <div data-desc="headshot" class="peer relative h-[26rem] rounded-2xl overflow-hidden hover:cursor-pointer">
    <Image
      src={profileImage}
      alt=`A picture of ${name}`
      class="h-full object-cover hover:scale-105 grayscale hover:grayscale-[25%] transition duration-300"
    />
    <div class="font-light absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 bg-black rounded-xl w-[19rem] h-[25rem] text-white p-2 invisible" data-desc="info">
      <div class="flex flex-col gap-5 overflow-auto h-full p-3 [color-scheme:dark]">
        <slot />
      </div>
    </div>
  </div>

  <div class="-z-10 transition duration-300 opacity-0 peer-hover:opacity-100 absolute -top-10 left-24 bg-color-blurb-2 w-36 h-[26rem] rounded-full rotate-[10deg] blur-3xl" data-desc="color-ellipsis" />
  <div class="-z-10 transition duration-300 opacity-0 peer-hover:opacity-100 absolute top-10 left-0 bg-color-blurb-4 w-36 h-[26rem] rounded-full rotate-[10deg] blur-3xl" data-desc="color-ellipsis" />
  <div class="-z-10 transition duration-300 opacity-0 peer-hover:opacity-100 absolute top-20 left-44 bg-color-blurb-3 w-36 h-[26rem] rounded-full rotate-[10deg] blur-3xl" data-desc="color-ellipsis" />

  <div class="px-2 mt-5">
    <h2 class="text-2xl font-bold mb-2"><span class="align-middle">{name}</span> <a href={`https://github.com/${githubUsername}`} aria-label="GitHub link"><GithubIcon class="inline w-6 h-6 ml-1 align-middle" /></a></h2>
    <h3 class="text-lg">{title}</h3>
    <h3 class="text-lg text-gray-50">{role}</h3>
  </div>
</div>

<script>
  document.querySelectorAll("[data-desc='headshot']").forEach(e => {
    const info = e.querySelector("[data-desc='info']")!;
    const img = e.querySelector("img")!;
    const colorEllipses = e.parentNode?.querySelectorAll("[data-desc='color-ellipsis']")!;

    e.addEventListener("click", () => {
      info.classList.toggle("invisible");
      img.classList.toggle("grayscale-[50%]");
      img.classList.toggle("scale-105");
      colorEllipses.forEach(el => el.classList.toggle("opacity-0"));
    })
  });
</script>
