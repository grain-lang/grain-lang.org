---
import type { CollectionEntry } from "astro:content";
import { Image } from "astro:assets";
import BlogAuthor from "./BlogAuthor.astro";
import ChevronRightIcon from "./icons/ChevronRightIcon.astro";
import DiscordIcon from "./icons/DiscordIcon.astro";
import RssIcon from "./icons/RssIcon.astro";
import GrainLogo from "./icons/GrainLogo.astro";
import BlueskyIcon from "./icons/BlueskyIcon.astro";

interface Props {
  entry: CollectionEntry<"blog">;
}

const { entry } = Astro.props;
---

<div class="mx-auto max-w-[70rem] pb-5 lg:pb-28 px-4">
  <div class="my-6 md:my-10 flex justify-between items-center">
    <div>
      <GrainLogo
        class="w-8 h-8 md:w-12 md:h-12 inline-block align-middle fill-color-accent"
      />
      <span class="md:pl-1 text-2xl md:text-4xl font-semibold align-middle"
        >The Grain Blog</span
      >
      <a
        href="/blog/rss.xml"
        target="_blank"
        aria-label="RSS feed link"
        class="hidden md:inline-block ml-2 align-middle"
      >
        <RssIcon class="w-10 h-10 fill-color-accent" />
      </a>
    </div>
    <div class="flex md:hidden gap-4 text-color-accent items-center">
      <a
        href="https://bsky.app/profile/grain-lang.org"
        target="_blank"
        aria-label="Bluesky link"
      >
        <BlueskyIcon class="w-7 h-7 fill-color-accent" />
      </a>
      <a
        href="https://discord.com/invite/grain-lang"
        target="_blank"
        aria-label="Discord link"
      >
        <DiscordIcon class="w-7 h-7 fill-color-accent" />
      </a>
      <a href="/blog/rss.xml" target="_blank" aria-label="RSS feed link">
        <RssIcon class="w-7 h-7 fill-color-accent" />
      </a>
    </div>
    <div class="hidden md:block text-color-accent">
      Also find us on
      <a href="https://bsky.app/profile/grain-lang.org" class="underline"
        >Bluesky</a
      >
      and
      <a href="https://discord.com/invite/grain-lang" class="underline"
        >Discord</a
      >
    </div>
  </div>
  <div
    class="lg:flex lg:items-stretch bg-color-background-bright dark:bg-gray-variant-80 rounded-lg p-4 lg:p-8 drop-shadow-xl"
  >
    <div class="p-0 lg:p-6 lg:w-5/12">
      <h1 class="text-2xl font-bold mb-5">
        <a href={`/blog/${entry.id}`}>{entry.data.title}</a>
      </h1>
      <BlogAuthor entry={entry} imgClass="w-12 h-12" nameClass="text-lg" />
      <p class="my-4">{entry.data.subtitle}</p>
      <p
        class="[mask-image:linear-gradient(180deg,#000_60%,transparent)] my-4 text-color-dim h-24 overflow-hidden"
      >
        {entry.body}...
      </p>
      <a
        href={`/blog/${entry.id}`}
        class="font-medium text-purple-50 hover:text-purple-70"
      >
        Read more
        <ChevronRightIcon class="inline-block w-4 mb-0.5" />
      </a>
    </div>
    <div class="w-0 lg:w-7/12 pl-6">
      <a href={`/blog/${entry.id}`}>
        <Image
          src={entry.data.cover}
          alt={entry.data.coverAttribution ?? `${entry.data.title} cover image`}
          class="w-full h-full object-cover rounded"
        />
      </a>
    </div>
  </div>
</div>
